class VulnerabilityPattern:
    def __init__(self, vulnerability_name, sources, sanitizers, sinks, implicit):
        self.vulnerability_name = vulnerability_name
        self.sources = sources
        self.sanitizers = sanitizers
        self.sinks = sinks
        self.implicit = implicit
        self.index = 0
    
    def add_source(self,source):
        self.sources.append(source)
    
    def add_sanitize(self,sanitizer):
        self.sanitizers.append(sanitizer)
    
    def add_sinks(self,sink):
        self.sinks.append(sink)
        
    def is_sink(self, id):
        return id in self.sinks
    
    def is_sanitizer(self, id):
        return id in self.sanitizers
    
    def inc_index(self):
        self.index += 1
        return self.index
    
    def __repr__(self):
        repr = 'vulnerability: ' + self.vulnerability_name + ', sources: {'
        
        # sources: list()
        l = len(self.sources)
        for i in range(l-1):
            repr += self.sources[i] + ','
        repr += self.sources[l-1] + '}, sanitizers: {'
        
        # sanitizers: list()
        l = len(self.sanitizers)
        if l != 0:
            for i in range(l-1):
                repr += self.sanitizers[i] + ','
            repr += self.sanitizers[l-1] + '}, sinks: {'
        else:
            repr += '}, sinks: {'
        
        # sink: list()
        l = len(self.sinks)
        for i in range(l-1):
            repr += self.sinks[i] + ','
        repr += self.sinks[l-1] + '}, implicit: ' + self.implicit
        
        return repr
